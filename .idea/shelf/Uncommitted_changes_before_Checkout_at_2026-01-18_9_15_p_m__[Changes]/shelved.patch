Index: web/app.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>// ---------- DOM ----------\r\nconst chat = document.getElementById(\"chat\");\r\nconst msgInput = document.getElementById(\"msgInput\");\r\nconst sendBtn = document.getElementById(\"sendBtn\");\r\n\r\n// Tabs / views\r\nconst tabButtons = document.querySelectorAll(\".tab\");\r\nconst views = document.querySelectorAll(\".view\");\r\n\r\n// ---------- Session ----------\r\nconst sessionId = localStorage.getItem(\"sessionId\") || crypto.randomUUID();\r\nlocalStorage.setItem(\"sessionId\", sessionId);\r\n\r\n// ---------- View switching ----------\r\nfunction setActiveView(viewId) {\r\n  views.forEach(v => v.classList.toggle(\"active\", v.id === viewId));\r\n  tabButtons.forEach(b => b.classList.toggle(\"active\", b.dataset.view === viewId));\r\n}\r\n\r\ntabButtons.forEach(btn => {\r\n  btn.addEventListener(\"click\", () => setActiveView(btn.dataset.view));\r\n});\r\n\r\n// ---------- Chat rendering ----------\r\nfunction addBubble(text, who) {\r\n  const div = document.createElement(\"div\");\r\n  div.className = `bubble ${who}`;\r\n  div.textContent = text;\r\n  chat.appendChild(div);\r\n  chat.scrollTop = chat.scrollHeight;\r\n}\r\n\r\n// ---------- Send message ----------\r\nasync function sendMessage() {\r\n  const text = msgInput.value.trim();\r\n  if (!text) return;\r\n\r\n  addBubble(text, \"user\");\r\n  msgInput.value = \"\";\r\n  msgInput.focus();\r\n\r\n  const payload = { sessionId, text };\r\n\r\n  try {\r\n    const res = await fetch(\"/api/message\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(payload)\r\n    });\r\n\r\n    if (!res.ok) {\r\n      addBubble(`Server error (${res.status}). Try again.`, \"bot\");\r\n      return;\r\n    }\r\n\r\n    const data = await res.json();\r\n    addBubble(data.text || \"No response text\", \"bot\");\r\n  } catch (err) {\r\n    addBubble(\"Network error. Is the Java server running?\", \"bot\");\r\n  }\r\n}\r\n\r\n// ---------- Events ----------\r\nsendBtn.addEventListener(\"click\", sendMessage);\r\nmsgInput.addEventListener(\"keydown\", (e) => {\r\n  if (e.key === \"Enter\") sendMessage();\r\n});\r\n\r\n// ---------- First message ----------\r\naddBubble(\"Hi, Iâ€™m Triage Bot. Iâ€™m here to help you understand how serious things might be. Tell me whatâ€™s going on, and Iâ€™ll ask a few questions to guide you.\", \"bot\");\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/web/app.js b/web/app.js
--- a/web/app.js	(revision 4704fb065ce39fe19487ff8cae8fb374fc9b74f1)
+++ b/web/app.js	(date 1768788807427)
@@ -1,20 +1,63 @@
-// ---------- DOM ----------
+// Title: app.js
+// Author: Ali Abbas
+// Description: Client-side logic for chat and database tab rendering.
+// Date: Sep 28, 2025
+// Version: 1.1.0
+
 const chat = document.getElementById("chat");
 const msgInput = document.getElementById("msgInput");
 const sendBtn = document.getElementById("sendBtn");
+const caseRows = document.getElementById("caseRows");
+const caseEmpty = document.getElementById("caseEmpty");
+<script>
+(function(){
+  const root = document.documentElement; // <html>
+  const btn = document.getElementById("themeToggle");
+  const STORAGE_KEY = "theme"; // "light" | "dark"
+
+  function applyTheme(theme){
+    if(theme === "dark") root.setAttribute("data-theme", "dark");
+    else root.removeAttribute("data-theme");
+
+    // Button label
+    if(btn){
+      btn.textContent = (theme === "dark") ? "â˜€ï¸ Light" : "ðŸŒ™ Dark";
+    }
+  }
+
+  // Load saved theme OR default to system preference
+  const saved = localStorage.getItem(STORAGE_KEY);
+  const systemPrefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
+  const initialTheme = saved || (systemPrefersDark ? "dark" : "light");
+  applyTheme(initialTheme);
+
+  // Toggle on click
+  btn?.addEventListener("click", () => {
+    const isDark = root.getAttribute("data-theme") === "dark";
+    const next = isDark ? "light" : "dark";
+    localStorage.setItem(STORAGE_KEY, next);
+    applyTheme(next);
+  });
+})();
+</script>
+
 
 // Tabs / views
 const tabButtons = document.querySelectorAll(".tab");
 const views = document.querySelectorAll(".view");
 
 // ---------- Session ----------
-const sessionId = localStorage.getItem("sessionId") || crypto.randomUUID();
+// Keep sessionId mutable so resetCase can start a brand-new session.
+let sessionId = localStorage.getItem("sessionId") || crypto.randomUUID();
 localStorage.setItem("sessionId", sessionId);
 
 // ---------- View switching ----------
 function setActiveView(viewId) {
   views.forEach(v => v.classList.toggle("active", v.id === viewId));
   tabButtons.forEach(b => b.classList.toggle("active", b.dataset.view === viewId));
+  if (viewId === "dbView") {
+    loadCases();
+  }
 }
 
 tabButtons.forEach(btn => {
@@ -54,6 +97,12 @@
     }
 
     const data = await res.json();
+    // If the case is locked, show the summary and a reset button
+        if (data.locked) {
+          addBubble(data.text || "No response text", "bot");
+          showResetButton();
+          return;
+        }
     addBubble(data.text || "No response text", "bot");
   } catch (err) {
     addBubble("Network error. Is the Java server running?", "bot");
@@ -68,3 +117,117 @@
 
 // ---------- First message ----------
 addBubble("Hi, Iâ€™m Triage Bot. Iâ€™m here to help you understand how serious things might be. Tell me whatâ€™s going on, and Iâ€™ll ask a few questions to guide you.", "bot");
+
+// ---------- Database view ----------
+async function loadCases() {
+  if (!caseRows) return;
+  caseRows.innerHTML = "";
+  caseEmpty.style.display = "none";
+
+  try {
+    // Fetch the latest summaries for the Database tab.
+    const res = await fetch("/api/cases");
+    if (!res.ok) {
+      caseEmpty.textContent = `Failed to load cases (${res.status}).`;
+      caseEmpty.style.display = "block";
+      return;
+    }
+    const data = await res.json();
+    if (!Array.isArray(data) || data.length === 0) {
+      caseEmpty.textContent = "No cases saved yet.";
+      caseEmpty.style.display = "block";
+      return;
+    }
+    data.forEach(caseItem => renderCaseRow(caseItem));
+  } catch (err) {
+    caseEmpty.textContent = "Failed to load cases. Is the Java server running?";
+    caseEmpty.style.display = "block";
+  }
+}
+
+function renderCaseRow(item) {
+  const row = document.createElement("div");
+  row.className = "case-row";
+
+  const started = formatDate(item.startedEpochMs);
+  row.appendChild(makeCell(started));
+  row.appendChild(makeCell(item.triageLevel || "â€”"));
+  row.appendChild(makeCell(item.severity || "â€”"));
+  row.appendChild(makeCell(item.duration || "â€”"));
+  row.appendChild(makeCell(String(item.notesCount ?? 0)));
+  row.appendChild(makeCell(String(item.redFlagCount ?? 0)));
+
+  caseRows.appendChild(row);
+}
+
+function makeCell(text) {
+  const div = document.createElement("div");
+  div.textContent = text;
+  return div;
+}
+
+function formatDate(epochMs) {
+  if (!epochMs) return "â€”";
+  const date = new Date(Number(epochMs));
+  if (Number.isNaN(date.getTime())) return "â€”";
+  return date.toLocaleString();
+}
+
+// ---------- Reset handling ----------
+function showResetButton() {
+  const div = document.createElement("div");
+  div.className = "bubble bot";
+  const btn = document.createElement("button");
+  btn.textContent = "Start a new case";
+  btn.className = "reset-btn";
+  btn.addEventListener("click", resetCase);
+  div.appendChild(btn);
+  chat.appendChild(div);
+  chat.scrollTop = chat.scrollHeight;
+}
+
+function resetCase() {
+  // Clear chat bubbles
+  chat.innerHTML = "";
+  // New session id
+  const newId = crypto.randomUUID();
+  sessionId = newId;
+  localStorage.setItem("sessionId", newId);
+  // Fresh intro
+  addBubble("New case started. Tell me whatâ€™s going on (symptoms, duration, severity).", "bot");
+}
+
+// ---------- UI helpers ----------
+function addOptions(options) {
+  const container = document.createElement("div");
+  container.className = "option-row";
+  options.forEach(opt => {
+    const btn = document.createElement("button");
+    btn.textContent = opt;
+    btn.className = "option-btn";
+    btn.addEventListener("click", () => {
+      msgInput.value = opt;
+      sendMessage();
+    });
+    container.appendChild(btn);
+  });
+  chat.appendChild(container);
+  chat.scrollTop = chat.scrollHeight;
+}
+
+function addBadgeRow(title, items) {
+  const div = document.createElement("div");
+  div.className = "badge-row";
+  const label = document.createElement("div");
+  label.className = "badge-title";
+  label.textContent = title + ":";
+  div.appendChild(label);
+  items.forEach(txt => {
+    const badge = document.createElement("span");
+    badge.className = "badge";
+    badge.textContent = txt;
+    div.appendChild(badge);
+  });
+  chat.appendChild(div);
+  chat.scrollTop = chat.scrollHeight;
+}
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_24\" default=\"true\" project-jdk-name=\"openjdk-24\" project-jdk-type=\"JavaSDK\">\r\n    <output url=\"file://$PROJECT_DIR$/out\" />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/misc.xml b/.idea/misc.xml
--- a/.idea/misc.xml	(revision 4704fb065ce39fe19487ff8cae8fb374fc9b74f1)
+++ b/.idea/misc.xml	(date 1768788826105)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
-  <component name="ProjectRootManager" version="2" languageLevel="JDK_24" default="true" project-jdk-name="openjdk-24" project-jdk-type="JavaSDK">
+  <component name="ProjectRootManager" version="2" languageLevel="JDK_25" default="true" project-jdk-name="openjdk-24" project-jdk-type="JavaSDK">
     <output url="file://$PROJECT_DIR$/out" />
   </component>
 </project>
\ No newline at end of file
